import{S as e,i as t,s as n,e as s,c as o,a as i,d as l,b as r,f as a,W as d,K as c,ah as u,t as p,g as f,h,b0 as g,l as y,b1 as m}from"./vendor-e28ff09b.js";const b="undefined"!=typeof window?window:void 0;function C(e,t,n={}){const s=Object.assign({tab:"\t",indentOn:/{$/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:b},n),o=s.window,i=o.document;let l,r,a=[],d=[],c=-1,u=!1;e.setAttribute("contenteditable","plaintext-only"),e.setAttribute("spellcheck",s.spellcheck?"true":"false"),e.style.outline="none",e.style.overflowWrap="break-word",e.style.overflowY="auto",e.style.whiteSpace="pre-wrap";let p=!1;t(e),"plaintext-only"!==e.contentEditable&&(p=!0),p&&e.setAttribute("contenteditable","true");const f=S((()=>{const n=C();t(e,n),E(n)}),30);let h=!1;const g=e=>!O(e)&&!L(e)&&"Meta"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&!e.key.startsWith("Arrow"),y=S((e=>{g(e)&&(T(),h=!1)}),300),m=(t,n)=>{a.push([t,n]),e.addEventListener(t,n)};function C(){const t=A(),n={start:0,end:0,dir:void 0};let{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:r}=t;if(!s||!l)throw"error1";if(s.nodeType===Node.ELEMENT_NODE){const e=i.createTextNode("");s.insertBefore(e,s.childNodes[o]),s=e,o=0}if(l.nodeType===Node.ELEMENT_NODE){const e=i.createTextNode("");l.insertBefore(e,l.childNodes[r]),l=e,r=0}return k(e,(e=>{if(e===s&&e===l)return n.start+=o,n.end+=r,n.dir=o<=r?"->":"<-","stop";if(e===s){if(n.start+=o,n.dir)return"stop";n.dir="->"}else if(e===l){if(n.end+=r,n.dir)return"stop";n.dir="<-"}e.nodeType===Node.TEXT_NODE&&("->"!=n.dir&&(n.start+=e.nodeValue.length),"<-"!=n.dir&&(n.end+=e.nodeValue.length))})),e.normalize(),n}function E(t){const n=A();let s,o,i=0,l=0;if(t.dir||(t.dir="->"),t.start<0&&(t.start=0),t.end<0&&(t.end=0),"<-"==t.dir){const{start:e,end:n}=t;t.start=n,t.end=e}let r=0;k(e,(e=>{if(e.nodeType!==Node.TEXT_NODE)return;const n=(e.nodeValue||"").length;if(r+n>t.start&&(s||(s=e,i=t.start-r),r+n>t.end))return o=e,l=t.end-r,"stop";r+=n})),s||(s=e,i=e.childNodes.length),o||(o=e,l=e.childNodes.length),"<-"==t.dir&&([s,i,o,l]=[o,l,s,i]),n.setBaseAndExtent(s,i,o,l)}function v(){const t=A().getRangeAt(0),n=i.createRange();return n.selectNodeContents(e),n.setEnd(t.startContainer,t.startOffset),n.toString()}function N(){const t=A().getRangeAt(0),n=i.createRange();return n.selectNodeContents(e),n.setStart(t.endContainer,t.endOffset),n.toString()}function w(e){if(p&&"Enter"===e.key)if(R(e),e.stopPropagation(),""==N()){$("\n ");const e=C();e.start=--e.end,E(e)}else $("\n")}function T(){if(!u)return;const t=e.innerHTML,n=C(),s=d[c];if(s&&s.html===t&&s.pos.start===n.start&&s.pos.end===n.end)return;c++,d[c]={html:t,pos:n},d.splice(c+1);c>300&&(c=300,d.splice(0,1))}function k(e,t){const n=[];e.firstChild&&n.push(e.firstChild);let s=n.pop();for(;s&&"stop"!==t(s);)s.nextSibling&&n.push(s.nextSibling),s.firstChild&&n.push(s.firstChild),s=n.pop()}function x(e){return e.metaKey||e.ctrlKey}function O(e){return x(e)&&!e.shiftKey&&"KeyZ"===e.code}function L(e){return x(e)&&e.shiftKey&&"KeyZ"===e.code}function $(e){e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),i.execCommand("insertHTML",!1,e)}function S(e,t){let n=0;return(...s)=>{clearTimeout(n),n=o.setTimeout((()=>e(...s)),t)}}function D(e){let t=e.length-1;for(;t>=0&&"\n"!==e[t];)t--;t++;let n=t;for(;n<e.length&&/[ \t]/.test(e[n]);)n++;return[e.substring(t,n)||"",t,n]}function M(){return e.textContent||""}function R(e){e.preventDefault()}function A(){var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.getSelection():o.getSelection()}return m("keydown",(t=>{t.defaultPrevented||(r=M(),s.preserveIdent?function(e){if("Enter"===e.key){const t=v(),n=N();let[o]=D(t),i=o;if(s.indentOn.test(t)&&(i+=s.tab),i.length>0?(R(e),e.stopPropagation(),$("\n"+i)):w(e),i!==o&&"}"===n[0]){const e=C();$("\n"+o),E(e)}}}(t):w(t),s.catchTab&&function(e){if("Tab"===e.key)if(R(e),e.shiftKey){const e=v();let[t,n]=D(e);if(t.length>0){const e=C(),o=Math.min(s.tab.length,t.length);E({start:n,end:n+o}),i.execCommand("delete"),e.start-=o,e.end-=o,E(e)}}else $(s.tab)}(t),s.addClosing&&function(e){const t="([{'\"",n=")]}'\"",s=N(),o=v(),i="\\"===o.substr(o.length-1),l=s.substr(0,1);if(n.includes(e.key)&&!i&&l===e.key){const t=C();R(e),t.start=++t.end,E(t)}else if(t.includes(e.key)&&!i&&("\"'".includes(e.key)||[""," ","\n"].includes(l))){R(e);const s=C(),o=s.start==s.end?"":A().toString();$(e.key+o+n[t.indexOf(e.key)]),s.start++,s.end++,E(s)}}(t),s.history&&(!function(t){if(O(t)){R(t),c--;const n=d[c];n&&(e.innerHTML=n.html,E(n.pos)),c<0&&(c=0)}if(L(t)){R(t),c++;const n=d[c];n&&(e.innerHTML=n.html,E(n.pos)),c>=d.length&&c--}}(t),g(t)&&!h&&(T(),h=!0)),p&&E(C()))})),m("keyup",(e=>{e.defaultPrevented||e.isComposing||(r!==M()&&f(),y(e),l&&l(M()))})),m("focus",(e=>{u=!0})),m("blur",(e=>{u=!1})),m("paste",(n=>{T(),function(n){R(n);const s=(n.originalEvent||n).clipboardData.getData("text/plain").replace(/\r/g,""),o=C();$(s),t(e),E({start:o.start+s.length,end:o.start+s.length})}(n),T(),l&&l(M())})),{updateOptions(e){Object.assign(s,e)},updateCode(n){e.textContent=n,t(e)},onUpdate(e){l=e},toString:M,save:C,restore:E,recordHistory:T,destroy(){for(let[t,n]of a)e.removeEventListener(t,n)}}}function E(e,t={}){const n=Object.assign({class:"codejar-linenumbers",wrapClass:"codejar-wrap",width:"35px",backgroundColor:"rgba(128, 128, 128, 0.15)",color:""},t);let s;return function(t){e(t),s||(s=function(e,t){const n=getComputedStyle(e),s=document.createElement("div");s.className=t.wrapClass,s.style.position="relative";const o=document.createElement("div");o.className=t.class,s.appendChild(o),o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.style.bottom="0px",o.style.width=t.width,o.style.overflow="hidden",o.style.backgroundColor=t.backgroundColor,o.style.color=t.color||n.color,o.style.setProperty("mix-blend-mode","difference"),o.style.fontFamily=n.fontFamily,o.style.fontSize=n.fontSize,o.style.lineHeight=n.lineHeight,o.style.paddingTop=n.paddingTop,o.style.paddingLeft=n.paddingLeft,o.style.borderTopLeftRadius=n.borderTopLeftRadius,o.style.borderBottomLeftRadius=n.borderBottomLeftRadius;const i=document.createElement("div");return i.style.position="relative",i.style.top="0px",o.appendChild(i),e.style.paddingLeft=`calc(${t.width} + ${o.style.paddingLeft})`,e.style.whiteSpace="pre",e.parentNode.insertBefore(s,e),s.appendChild(e),i}(t,n),t.addEventListener("scroll",(()=>s.style.top=`-${t.scrollTop}px`)));const o=(t.textContent||"").replace(/\n+$/,"\n").split("\n").length+1;let i="";for(let e=1;e<o;e++)i+=`${e}\n`;s.innerText=i}}function v(e){let t;return{c(){t=p(e[1])},l(n){t=f(n,e[1])},m(e,n){a(e,t,n)},p(e,n){2&n&&h(t,e[1])},d(e){e&&l(t)}}}function N(e){let t,n,s=e[4](e[1],e[5])+"";return{c(){t=new g,n=y(),this.h()},l(e){t=m(e),n=y(),this.h()},h(){t.a=n},m(e,o){t.m(s,e,o),a(e,n,o)},p(e,n){50&n&&s!==(s=e[4](e[1],e[5])+"")&&t.p(s)},d(e){e&&l(n),e&&t.d()}}}function w(e){let t,n,u,p;function f(e,t){return!e[6]&&e[4]?N:v}let h=f(e),g=h(e);return{c(){t=s("pre"),n=s("code"),g.c(),this.h()},l(e){t=o(e,"PRE",{class:!0,style:!0});var s=i(t);n=o(s,"CODE",{class:!0,"data-language":!0});var r=i(n);g.l(r),r.forEach(l),s.forEach(l),this.h()},h(){r(n,"class",u=e[5]?`language-${e[5]}`:""),r(n,"data-language",e[5]),r(t,"class",p=(e[5]?`language-${e[5]}`:"")+" "+e[2]),r(t,"style",e[3])},m(s,o){a(s,t,o),d(t,n),g.m(n,null),e[13](t)},p(e,[s]){h===(h=f(e))&&g?g.p(e,s):(g.d(1),g=h(e),g&&(g.c(),g.m(n,null))),32&s&&u!==(u=e[5]?`language-${e[5]}`:"")&&r(n,"class",u),32&s&&r(n,"data-language",e[5]),36&s&&p!==(p=(e[5]?`language-${e[5]}`:"")+" "+e[2])&&r(t,"class",p),8&s&&r(t,"style",e[3])},i:c,o:c,d(n){n&&l(t),g.d(),e[13](null)}}}function T(e,t,n){let{element:s=null}=t,{class:o=""}=t,{style:i}=t,{addClosing:l=!0}=t,{indentOn:r=/{$/}=t,{spellcheck:a=!1}=t,{tab:d="\t"}=t,{withLineNumbers:c=!1}=t,{highlightCode:p=null}=t,{highlightElement:f=((e,t)=>{})}=t,{syntax:h}=t,{value:g=""}=t,y=null;function m(e,t,o,i){y&&function(){y.destroy();const e=s.parentElement;if(e.classList.contains("codejar-wrap")){const t=e.parentElement;n(0,s.style.padding="",s),t.appendChild(s),e.remove()}}();const c=o?E((e=>t(e,i))):e=>t(e,i);n(6,y=C(e,c,{addClosing:l,indentOn:r,spellcheck:a,tab:d})),y.onUpdate((e=>{e!==g&&n(1,g=e)}))}return e.$$set=e=>{"element"in e&&n(0,s=e.element),"class"in e&&n(2,o=e.class),"style"in e&&n(3,i=e.style),"addClosing"in e&&n(7,l=e.addClosing),"indentOn"in e&&n(8,r=e.indentOn),"spellcheck"in e&&n(9,a=e.spellcheck),"tab"in e&&n(10,d=e.tab),"withLineNumbers"in e&&n(11,c=e.withLineNumbers),"highlightCode"in e&&n(4,p=e.highlightCode),"highlightElement"in e&&n(12,f=e.highlightElement),"syntax"in e&&n(5,h=e.syntax),"value"in e&&n(1,g=e.value)},e.$$.update=()=>{6177&e.$$.dirty&&s&&m(s,f,c,h),1984&e.$$.dirty&&y&&y.updateOptions({addClosing:l,indentOn:r,spellcheck:a,tab:d}),66&e.$$.dirty&&y&&y.toString()!==g&&y.updateCode(g)},[s,g,o,i,p,h,y,l,r,a,d,c,f,function(e){u[e?"unshift":"push"]((()=>{s=e,n(0,s)}))}]}var k=class extends e{constructor(e){super(),t(this,e,T,w,n,{element:0,class:2,style:3,addClosing:7,indentOn:8,spellcheck:9,tab:10,withLineNumbers:11,highlightCode:4,highlightElement:12,syntax:5,value:1})}};export{k as CodeJar};
